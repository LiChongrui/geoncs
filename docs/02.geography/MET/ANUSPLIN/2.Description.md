---
title: 模型说明
date: 2018-10-08 23:00:00
tags:
 - AUNSPLIN
categories:
 - 地理研学
---

## 算法原理
&emsp;&emsp; ANUSPLIN 采用局部薄盘光滑样条法。其理论统计模型表达方法如下：

$$\ z_i  = f(x_i) + b^{T}y_i + e_i\quad i = 1,2, … , N$$ 

&emsp;&emsp; 其中，$\ z_i$ 是位于空间 $\ i$ 点的因变量；$\ x_i$为 $\ d$  维样条独立变量，$\ f$ 是要估算的关于$\ x_i$ 的未知光滑函数；$\ y_i$ 为  $\ p$ 维独立协变量； $\ b$ 为  $\ y_i$ 的 $\ p$ 维系数； $\ e_i$ 为具有期望值为 0 且方差为 $\ w_i \sigma_2$ 的自变量随机误差；$\ w_i$ 是作为权重的已知局部相对变异系数，$\sigma_2$ 为误差协方差，在所有数据点上为常数，但通常未知。

&emsp;&emsp;若 $\ p=0$，则模型简化为简化为薄盘光滑样条原型。函数$\ f$ 和系数 $\ b$采用最小二乘法估计来确定：

$$\sum_{i=1}^{N}((z_i-f(x_i)-b^Ty_i)/w_i)^2  +ρJ_m(f)$$

&emsp;&emsp;其中，$\ J_m(f)$是函数$\  f(x_i)$ 的粗糙度测度函数(样条次数),定义为函数$\  f$ 的 $\ m$ 阶偏导，$\ ρ$ 是正的光滑参数，通常由广义交叉验证 GCV 的最小化来确定。

*&emsp;&emsp;其他更具体的参数计算参见 ANUSPLIN 说明文件。*


## 模块描述

程序模块 |描述
:-------- | :-----
SPLINA| 适用于站点数<2000 的任意个独立变量或多个协变量的薄盘样条函数。数据平滑度由 GCV 或 GML 决定。
SPLINB|功能与 SPLINA 类似，站点数>2000 数据利用 SELNOT 进行节点选择,最多 10000 个站点，2000 个节点。
SELNOT|为 SPLINB 添加初始节点
ADDNOT|为 SPLINB 添加数据节点
DELNOT|为 SPLINB 删除数据节点
GCVGML|计算每个表面的 GCV 或 GML，以及平滑参数范围内所有表面的平均 GCV 或 GML。可用于样条优化参数。将 GCV 或 GML 值写入文件，以供检查和绘图。
LAPPNT|计算预测值或贝叶斯标准误差估计的点文件
LAPGRD|生成拟合曲面和贝叶斯标准误差曲面

::: theorem 主要模块
**ANUSPLIN 插值主要使用 SPLINA、LAPGRD 模块。**
:::

## 光滑样条函数模型

&emsp;&emsp;以下列出了 18 个薄盘光滑样条函数模型，供大家参考。

模型序号 |变量（协变量）|样条次数|模 型 缩写|含义
 :------ | :----- | :----- | :----- | :-----
1|经度,纬度|2|BVTPS2|双变量薄盘光滑样条函数
2|经度,纬度|3|BVTPS3|双变量薄盘光滑样条函数
3|经度,纬度|4|BVTPS4|双变量薄盘光滑样条函数
4|经度,纬度(高程)|2|TVPTPS2|三变量局部薄盘光滑样条函数
5|经度,纬度(高程)|3|TVPTPS3|三变量局部薄盘光滑样条函数
6|经度,纬度(高程)|4|TVPTPS4|三变量局部薄盘光滑样条函数
7|经度,纬度,高程(m)|2|TVTPS2|三变量薄盘光滑样条函数
8|经度,纬度,高程(m)|3|TVTPS3|三变量薄盘光滑样条函数
9|经度,纬度,高程(m)|4|TVTPS4|三变量薄盘光滑样条函数
10|经度,纬度,高程(km)|2|TVTPS2|三变量薄盘光滑样条函数
11|经度,纬度,高程(km)|3|TVTPS3|三变量薄盘光滑样条函数
12|经度,纬度,高程(km)|4|TVTPS4|三变量薄盘光滑样条函数
13|经度,纬度,高程(dm)|2|TVTPS2|三变量薄盘光滑样条函数

::: theorem
具体情况请 **结合实际数据和需求** 分析和选择。
:::

## 最佳模型参考

气象要素|模型|独立变量|独立协变量|数据转换方式|样条次数
 :------ | :----- | :----- | :----- | :----- | :-----
月平均最高气温|TVPTPS|经度,纬度|高程||2,3
月平均最低气温|TVPTPS|经度,纬度|高程||2,3
月平均风速|TVPTPS|经度,纬度|高程||2
月降雨量 \ 整散量|BVTPS|经度,纬度||平方根转换|2
水汽压|TVPTPS|经度,纬度|高程||2
月日照时数|TVPTPS|经度,纬度|月温度范围||2,3
净辐射|SRAD+TVPTS|经度,纬度|年辐射,地表覆盖,地形等||2,3
蒸发皿蒸发|QVPTPS|经度,纬度|净辐射,水气压差,风速||2,3,4

::: theorem 
**对于日、年等数据，也可尝试选择以上模型。**
::: 
